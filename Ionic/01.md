# Ionic 6 - Partie 1 : D√©couverte de Ionic
> - [Retourner √† la liste des cours](../readme.md)
> - Exercices : [cliquez-ici](exercices.md)
> - Corrections : [cliquez-ici](corrections.md)

- [Ionic 6 - Partie 1 : D√©couverte de Ionic](#ionic-6---partie-1--d%c3%a9couverte-de-ionic)
  - [Ionic, Capacitor, Cordova](#ionic-capacitor-cordova)
  - [Installation de Ionic](#installation-de-ionic)
  - [Cr√©er notre premi√®re application Ionic](#cr%c3%a9er-notre-premi%c3%a8re-application-ionic)
  - [Ouvrir le projet](#ouvrir-le-projet)
    - [Exercice 1](#exercice-1)
    - [Exercice 2](#exercice-2)
    - [Exercice 3](#exercice-3)
  - [G√©rer la logique avec des Services](#g%c3%a9rer-la-logique-avec-des-services)
    - [Exercice 4](#exercice-4)

> Ionic est un framework vous permettant de d√©velopper des applications mobiles multi-plateforme. D√©velopp√© sur Angular, il vous permet d'utiliser Typescript et vos connaissances en Angular pour cr√©er une application qui pourra √™tre publi√©e pour Android ou iOS par exemple !

La cr√©ation d'applications mobiles passe par deux m√©thodes principales :
- utiliser les langages natifs (Swift et Objective-C pour iOS, Java pour Android, C# pour les anciens Windows Phone...)
- utiliser un framework qui vous permet de coder dans un langage du web, par exemple en structurant en HTML/CSS et en cr√©ant la logique en Javascript

Utiliser des langages natifs permet d'avoir une application plus optimis√©e, d'utiliser les technologies les plus r√©centes propos√©es par les constructeurs, n√©anmoins ils requi√®rent d'apprendre un nouveau langage et pour de tr√®s nombreux cas, nous n'avons pas besoin d'autant de fonctonnalit√©s. De plus, il va falloir coder l'application deux fois, une fois pour iOS, une fois pour Android.

Utiliser les langages du web pour faire une application permet d'avoir la m√™me base de code pour tous les appareils ! Par exemple, lorsque vous voudrez utiliser l'appareil photo, vous le direz √† la mani√®re de Ionic qui se chargera lors de la compilation de convertir votre code en un appel natif √† l'appareil photo c√¥t√© iOS pour la version AppStore, et c√¥t√© Android pour la version Play Store. Le d√©savantage, c'est que vous n'avez pas acc√®s aux fonctionnalit√©s les plus pouss√©es ou trop propres √† un appareil en particulier. De plus, votre code ne pourra pas √™tre aussi optimis√© que si vous l'aviez cod√© en langage natif.

C'est un peu comme utiliser un cr√©ateur de sites web en ligne pour faire son site : c'est tr√®s rapide et pratique, on a acc√®s √† la plupart des fonctionnalit√©s communes aux sites Internet, n√©anmoins il sera impossible d'utiliser des fonctionnalit√©s tr√®s avanc√©es.

Notez cependant, les limites de Ionic sont nettement plus √©lev√©es ! On se servira d'un langage natif plut√¥t lorsque vous aurez besoin de ressources machines optimales (jeux vid√©os, machine learning...).

Il existe des alternatives √† Ionic, notamment React Native. React Native se base sur le m√™me fonctionnement que React, mais utilise son propre langage de rendu plut√¥t que HTML/CSS. Le code compil√© est natif l√† o√π Ionic compile un "site web mobile" : les applications React sont dont plus optimis√©es mais les applications Ionic sont plus rapides √† d√©velopper et √† mettre en page.

## Ionic, Capacitor, Cordova

Ionic est le framework qui va nous permettre de composer notre application : il nous fournit tous les outils de templating, routage... n√©cessaires √† coder avec du code Angular ou React.

Cordova et Capacitor sont la surcouche mat√©rielle qui va nous permettre d'utiliser les √©l√©ments plus "physiques" de l'appareil (capteur de mouvement, de luminosit√©, microphone, cam√©ra, gyroscope...)

## Installation de Ionic

Tout comme Angular, Ionic a besoin de NPM pour √™tre install√©. V√©rifiez que Node et NPM soient bien install√©s (`node -v`, `npm -v`) puis installez globalement Ionic :

```bash
npm install -g @ionic/cli native-run cordova-res
```
- `native-run` sert √† lancer des ex√©cutables iOS/Android
- `cordova-res` contient des ressources autour de la gestion d'applications

## Cr√©er notre premi√®re application Ionic

> Nous allons nous inspirer de l'application de d√©mo de la documentation : une app de photos !

Ionic vient avec plusieurs "templates" d'applications basiques: 'blank' pour un projet vide mono-page, "tabs" pour avoir des tabs de navigation, "sidemenu" pour avoir une sidebar de navigation. ([doc](https://ionicframework.com/docs/developing/starting)). 

> Consultez la liste des templates existants avec `ionic start --list`

Cr√©ez une premi√®re application :

```bash
ionic start photo-gallery tabs
```

- Pick a framework: `Angular`
- Integrate your new app with Capacitor: `yes`
- Create a free Ionic account: `No` (comme vous voulez)

Le CLI Ionic permet de g√©n√©rer de nombreux types de fichiers:

> Consultez la liste des g√©n√©rateurs avec `ionic generate`

Enfin, Ionic vient avec un nombre de "UI Components" (attention, on parle ici des composants d'interface utilisateur, pas des *components* Angular) qui vous permet de structurer votre application avec des √©l√©ments communs √† iOS et Android :

> Regardez la d√©mo d'application iOS/Android sur [la page d'accueil de la doc](https://ionicframework.com/docs/)

> Documentation compl√®te des [UI components](https://ionicframework.com/docs/components)

## Ouvrir le projet

Nous allons installer la librairie *PWA (Progressive Web App) Elements* :
> Ouvrez le projet dans VSCode
> Ouvrez un terminal et installez : `npm install @ionic/pwa-elements`

Il s'agit de plugins √† Capacitor qui incluent par exemple l'API de gestion de la cam√©ra.

Comme il s'agit d'une librairie externe, il faut bien l'importer dans le projet. Modifiez le fichier `main.ts` ainsi :

![](img/0101.png)

Ensuite, lancez le projet !

```
ionic serve
```

> Ouvrez les DevTools et mettez-vous en format mobile :

![](img/0102.png)

√áa y est, notre premi√®re application mobile est cr√©√©e ! üòÑ

En fait, dans Ionic, tout va fonctionner en UI components comme nos tabs qui sont d√©j√† pr√®tes. L'avantage, c'est qu'ils prennent les standards de design de Google ou de Apple, avec le m√™me code de base.

---

### Exercice 1
- Changez le titre du deuxi√®me tab en allant dans le component `src/app/tab2` et remplacez-le  par "Photo Gallery"
- Il y a deux endroits dans le m√™me fichier o√π il faut changer le titre !

Le titre est chang√© √† deux endroits √† cause du support d'une feature iOS dans la gestion des titres larges.

---

Ajoutons des √©l√©ments dans notre page :

---

### Exercice 2
- Ajoutez un bouton "Cam√©ra" dans cette page Tab2. Vous pouvez trouver [la documentation ici](https://ionicframework.com/docs/api/fab). Le bouton doit √™tre simple (comme le bouton rouge de la documentation, pas de menu quand on clique dessus) et se trouve en bas au milieu :

![](img/0103.png)

> Note: le code se place toujours dans `ion-content` :

![](img/0104.png)

---

---

### Exercice 3

- Modifiez le fichier `src/app/tabs.page.html` pour modifier le nom et  l'apparence du deuxi√®me onglet. Vous trouverez une liste d'ic√¥nes [dans ce lien !](https://ionicons.com/)

![](img/0105.png)

---

## G√©rer la logique avec des Services

Les services sont des classes dans lesquelles nous allons placer des morceaux de code utiles de partout dans l'application. Une m√©thode qui fait de la traduction, une m√©thode qui g√®re les droits utilisateurs... ou une m√©thode qui permet d'activer une photo : ces √©l√©ments l√† peuvent √™tre potentiellement utilis√©s de  partout  dans le code !

Par exemple, pour les photos : plut√¥t que  d'√©crire deux fois la m√©thode nous permettant de prendre une photo si nous en avions besoins dans deux *pages* (l'√©quivalent  des *components* Angular) nous n'allons l'√©crire qu'une seule fois dans une classe "bo√Æte √† outils", que nous importerons au besoin.

Ces classes bo√Æte √† outils, ce sont les services !

> Cr√©ez un service avec `ionic g service services/photo`.

Dans ce service importez les outils suivants (ils concernent la gestion de l'appareil photo et le stockage de donn√©es) :

```ts
import { Plugins, CameraResultType, Capacitor, FilesystemDirectory, 
         CameraPhoto, CameraSource } from '@capacitor/core';

const { Camera, Filesystem, Storage } = Plugins;
```

Ensuite, ajoutez la m√©thode suivante : elle appelle la classe `Camera`, et la m√©thode `getPhoto()` de cette classe, pour prendre une photo.


```ts
public async addNewToGallery() {
  // Take a photo
  const capturedPhoto = await Camera.getPhoto({
    resultType: CameraResultType.Uri, 
    source: CameraSource.Camera, 
    quality: 100 
  });
}
```

![](img/0106.png)


Ensuite, importez ce service dans `tab2.page.ts` pour que notre page puisse l'utiliser :

```ts
import { PhotoService } from '../services/photo.service';
// ...
constructor(public photoService: PhotoService) { }
```

![](img/0107.png)

> Note: le constructor est une m√©thode qui est lanc√©e au d√©marrage d'une classe. Ici, lorsque notre classe tabs2 est charg√©e par Ionic, elle s'ex√©cute. Gr√¢ce √† une technologie que nous verrons plus tard, *l'injection de d√©pendances*, on va venir "injecter" notre service au d√©marrage de l'application. Ici, nous disons que nous d√©clarons un attribut `photoService` qui sera de type `PhotoService` (c'est une instance de la classe PhotoService que nous venons de faire).

---

### Exercice 4

- Modifiez le bouton "photo" pour lui ajouter l'√©coute du clic en event binding. L'action r√©alis√©e sera `photoService.addNewToGallery()`.

---